--- 
title: "My Bookdown Template"
author: |
 |
 | Prepared for

 |
 |
 | Prepared by
 | Al Irvine, B.Sc., R.P.Bio. and Lucy Schick, B.Sc.
 | New Graph Environment Ltd.

date: |
 |
 | Version 0.0.4 `r format(Sys.Date(), "%Y-%m-%d")`
toc-title: Table of Contents
site: bookdown::bookdown_site
output: 
  bookdown::gitbook:
          includes:
            in_header: header.html
params:
  repo_url: 'https://github.com/NewGraphEnvironment/fish_passage_template_reporting'
  report_url: 'https://www.newgraphenvironment.com/fish_passage_template_reporting/'
  job_name: 'fish_passage_template_reporting'
  update_packages: FALSE
nocite: |
  @irvine2024NewGraphEnvironmentfpr
documentclass: book
bibliography: "`r rbbt::bbt_write_bib('references.bib', overwrite = TRUE)`"
biblio-style: apalike
link-citations: no
github-repo: rstudio/bookdown-demo
description: "My Description."
lof: true

---

```{r switch-gitbook-html, echo=FALSE}
gitbook_on <- TRUE
# gitbook_on <- FALSE  ##we just need turn  this on and off to switch between gitbook and pdf via paged.js

```


```{r jquery, echo=FALSE, eval=FALSE}
#see https://github.com/NewGraphEnvironment/mybookdown-template/issues/16
htmltools::tagList(rmarkdown::html_dependency_jquery())
```


```{r setup, echo=identical(gitbook_on, TRUE), include = TRUE}
knitr::opts_chunk$set(echo=identical(gitbook_on, TRUE), message=FALSE, warning=FALSE, dpi=60, out.width = "100%")
# knitr::knit_hooks$set(webgl = hook_webgl)
options(scipen=999)
options(knitr.kable.NA = '--') #'--'
options(knitr.kable.NAN = '--')
```

```{r settings-gitbook, eval= gitbook_on}
photo_width <- "100%"
font_set <- 11

```

```{r settings-paged-html, eval= identical(gitbook_on, FALSE)}
photo_width <- "80%"
font_set <- 9
```


```{r source}
source('scripts/packages.R')
source('scripts/functions.R')
source('scripts/staticimports.R')

```


```{r include=FALSE}
# automatically create a bib database for R packages
knitr::write_bib(c(
  .packages(), 'bookdown', 'knitr', 'rmarkdown'
), 'packages.bib')
```

# Acknowledgement {.front-matter .unnumbered}


Modern civilization has a long journey ahead to acknowledge and address the historic and ongoing impacts of colonialism that have resulted in harm to the cultures and livelihoods living interconnected with our ecosystems for many thousands of years. 



```{js, logo-header, echo = FALSE, eval= T}
title=document.getElementById('header');
title.innerHTML = '<img src="fig/nge-full_white.png" alt="NewGraph">' + title.innerHTML
```


<!--chapter:end:index.Rmd-->

# Introduction {#intro}

`r if(identical(gitbook_on, FALSE))knitr::asis_output(paste0("This report is available as pdf and as an online interactive report at ", params$report_url, ". We recommend viewing online as the web-hosted html version contains more features and is more easily navigable."))`

`r if(identical(gitbook_on, FALSE)){knitr::asis_output("<br>")}`

Since 2020, the Society for Ecosystem Restoration Northern British Columbia (SERNbc) has been actively involved in planning, coordinating, and conducting fish passage restoration efforts within the Bulkley River and Morice River watershed groups, which are sub-basins of the Skeena River watershed. In 2022, the study area was expanded to include the Zymoetz River watershed group and the Kispiox River watershed group, followed by an extension in 2023 to encompass sections of the Kitsumkalum River watershed group, particularly where Highway 16 intersects the watershed.

<br>

The primary objective of this project is to identify and prioritize fish passage barriers within these study areas,
develop comprehensive restoration plans to address these barriers, and foster momentum for broader ecosystem restoration
initiatives. While the primary focus is on fish passage, this work also serves as a lens through which to view the
broader ecosystems, leveraging efforts to build capacity for ecosystem restoration and improving our understanding of
watershed health. We recognize that the health of life - such as our own - and the health of our surroundings are
interconnected, with our overall well-being dependent on the health of our environment.

<br>

Although the main purpose of this report is to document 2023 field work data and results, it also builds on reporting 
from field activities conducted from 2020 to 2022. In addition to the numerous assessments at sites undocumented in past
years of the project, field activities were also conducted at 10 sites where habitat confirmations
were previously documented as per the report links below. The reports for these sites were edited and updated with 2023 data.

- [Bulkley River and Morice River Watershed Groups Fish Passage Restoration Planning (2020)](https://newgraphenvironment.github.io/fish_passage_bulkley_2020_reporting/)
- [Bulkley River and Morice River Watershed Groups Fish Passage Restoration Planning 2021](https://newgraphenvironment.github.io/fish_passage_skeena_2021_reporting/)
- [Bulkley River Watershed Fish Passage Restoration Planning 2022](https://newgraphenvironment.github.io/fish_passage_bulkley_2022_reporting/)
- [Skeena Watershed Fish Passage Restoration Planning 2022](https://newgraphenvironment.github.io/fish_passage_skeena_2022_reporting/)


<br>

Please note that at the time of reporting, this document was a living document changing over time.  Version numbers are
logged for each release with modifications, enhancements and other changes tracked with the "Changlog" section.
Additionally, issues and planned enhancements are tracked
[here](https://github.com/NewGraphEnvironment/fish_passage_skeena_2023_reporting/issues).

<br>


The health and viability of freshwater fish populations can depend on access to tributary and off channel areas which
provide refuge during high flows, opportunities for foraging, overwintering habitat, spawning habitat and summer rearing
habitat [@bramblett_etal2002SeasonalUse; @swalesRoleOffChannelPonds1989; @diebel_etal2015EffectsRoad].  Culverts can
present barriers to fish migration due to low water depth, increased water velocity, turbulence, a vertical drop at the
culvert outlet and/or maintenance issues [@slaneyFishHabitatRehabilitation1997; @cote_etal2005Fishpassage]. As road
crossing structures are commonly upgraded or removed there are numerous opportunities to restore connectivity by
ensuring that fish passage considerations are incorporated into repair, replacement, relocation and deactivation
designs.

<br>

Although remediation and replacement of stream crossing structures can have benefits to local fish populations, the
costs of remedial works can be significant and the impacts of the work often complex to evaluate and quantify.
Additionally, allocation of ecosystem restoration funding towards infrastructure upgrades on transportation right of
ways are not always considered ethical under all circumstances from all perspectives. When funds are finite and invested
groups are engaged in fund raising, cost benefits and the ethics of crossing replacements should be explored
collaboratively alongside the cost benefits and ethics of alternative investment activities including transportation
corridor relocation/deactivation, land procurement/covenant, cattle exclusion, riparian/floodplain restoration, habitat
complexing, water conservation,  commercial/recreational fishing management, salt water interventions and research.

<!--chapter:end:0100-intro.Rmd-->

# Background

The study area includes the Bulkley River, Zymoetz River, Kispiox River, Morice River and Kitsumkalum River watershed groups (Figure \@ref(fig:overview-map)) and is within the traditional territories of the Wet'suwet'en, Gitxsan and Tsimshian.

<br>

```{r overview-map, fig.cap = 'Overview map of Study Areas',eval=T}
knitr::include_graphics("fig/fishpassage_overview.png")
```


## Wet'suwet'en

Wet'suwet'en hereditary territory covers an area of 22,000km^2^ including the Bulkley River and Morice River watersheds and portions of the Nechako River watershed. The Wet'suwet'en people are a matrilineal society organized into the Gilseyhu (Big Frog), Laksilyu (Small Frog), Tsayu (Beaver clan), Gitdumden (Wolf/Bear) and Laksamshu (Fireweed) clans. Within each of the clans there are are a number of kin-based groups known as Yikhs or House groups. The Yikh is a partnership between the people and the territory. Thirteen Yikhs with Hereditary Chiefs manage a total of 38 distinct territories upon which they have jurisdiction. Within a clan, the head Chief is entrusted with the stewardship of the House territory to ensure the Land is managed in a sustainable manner. Inuk Nu'at'en (Wet'suwet'en law) governing the harvesting of fish within their lands are based on values founded on thousands of years of social, subsistence and environmental dynamics. The Yintahk (Land) is the centre of life as well as culture and it's management is intended to provide security for sustaining salmon, wildlife, and natural foods to ensure the health and well-being of the Wet'suwet'en [@officeofthewetsuweten2013Wetsuwet; @OfficeWetsuwet2021; @flnrord2017NaturalResource].

<br>

## Gitxsan

Gitxsan means "People of the River Mist". The Gitxsan Laxyip (traditional territories) covers an area of 33,000km^2^ within the Skeena River and Nass River watersheds. The Laxyip is governed by 60 Simgiigyet (Hereditary Chiefs), within the traditional hereditary system made up of Wilps (House groups). Anaat are fisheries tenures found throughout the Laxyip. Traditional governance within a matrilineal society operates under the principles of Ayookw (Gitxsan law) [@GitxsanHuwilpGovernment]. Many band members live in Hazelton, Kispiox and Glen Vowell (the Eastern Gitxsan) as well as within Kitwanga, Kitwankool and Kitsegukla (the Western Gitxsan) [@powell_etal2018Gitxsan].

```{r}
# Salmon is considered the source of life and always treated with high regard.  It was brought by the Raven who also taught people how to fish and hunt.

 # The original Gitxsan economy depended heavily on the trade of fish and other natural resources with neighbouring First Nations along "grease trails," which are routes named so because they carried the refined oil of the oolichan, a fish that resembles a smelt that is common in some areas of British Columbia. They are also known for their range of traditional arts 

```

## Tsimshian
The Kitsumkalum community, part of the Tsimshian Nation, maintains a rich cultural heritage rooted in ancient traditions and values. Their society, governed by Tsimshian Law (ayaawx), emphasizes strong connections through marriages, adoptions, and resource sharing with other Tsimshian tribes. The community upholds its cultural and spiritual practices, including fishing, harvesting, and land stewardship, despite the impacts of colonization [@kitsumkalumbandOurCulture].

<br>


Kitsumkalum's social structure is based on matrilineal kinship, with significant emphasis on family ties through the mother’s lineage. Their cultural identity is expressed through crest groups (pteex), lineage houses (waap), and the importance of landed property (laxyuup), which ties them to their ancestral territories. The community combines traditional governance with modern administrative functions, reflecting their resilience and commitment to preserving their heritage [@kitsumkalumbandOurCulture].

<br>

The Kitsumkalum River salmon populations have been an important part of their culture and economy [@gottesfeld_rabnett2007SkeenaFish]. 


## Bulkley River

The Bukley River is an 8th order stream that drains an area of 7,762km^2^ in a generally northerly direction from Bulkley Lake on the Nechako Plateau to its confluence with the Skeena River at Hazleton. It has a mean annual discharge of `r round(fasstr::calc_longterm_mean(station_number = "08EE004")$LTMAD,1)` m^3^/s at station 08EE004 located near Quick (\~27km south of Telkwa) and `r round(fasstr::calc_longterm_mean(station_number = "08EE003")$LTMAD,0)` m^3^/s at station 08EE003 located upstream near Houston. Flow patterns at Quick are heavily influenced by inflows from the Morice River (enters just downstream of Houston) resulting in flow patterns typical of high elevation watersheds which receive large amounts of precipitation as snow leading to peak levels of discharge during snowmelt, typically from May to July (Figures \@ref(fig:hydrology-plot) - \@ref(fig:hydrology-stats1)). The hydrograph peaks faster and generally earlier (May - June) for the Bulkley River upstream of Houston where the topography is of lower lower elevation (Figures \@ref(fig:hydrology-plot) and \@ref(fig:hydrology-stats2)).

<br>

Changes to the climate systems are causing impacts to natural and human systems on all continents with alterations to hydrological systems caused by changing precipitation or melting snow and ice increasing the frequency and magnitude of extreme events such as floods and droughts [@calvin_etal2023IPCCSummary; @eccc2016Climatedata]. These changes are resulting in modifications to the quantity and quality of water resources throughout British Columbia and are likely to compound issues related to drought and flooding in the Bulkley River watershed where numerous water licenses are held with a potential over-allocation of flows identified during low flow periods [@ilmb2007MoriceLand].

<br>

The valley bottom has seen extensive settlement over the past hundred years with major population centers including the Village of Hazelton, the Town of Smithers, the Village of Telkwa and the District Municipality of Houston. As a major access corridor to northwestern British Columbia, Highway 16 and the Canadian National Railway are major linear developments that run along the Bulkley River within and adjacent to the floodplain with numerous crossing structures impeding fish access into and potentially out from important fish habitats. Additionally, as the valley bottom contains some of the most productive land in the area, there has been extensive conversion of riparian ecosystems to hayfields and pastures leading to alterations in flow regimes, increases in water temperatures, reduced streambank stability, loss of overstream cover and channelization [@ilmb2007MoriceLand; @wilson_rabnett2007FishPassage].

<br>

```{r, eval=F}
sfpr_create_hydrograph("08EE003", start_year = 1980)
```

```{r, eval=F}
sfpr_create_hydrograph("08EE004")
```

```{r hydrology-plot, fig.cap = 'Hydrograph for Bulkley River at Quick (Station #08EE004) and near Houston (Station #08EE003).', fig.show="hold", out.width= c("49.5%","1%","49.5%"), eval=T}
knitr::include_graphics("fig/hydrograph_08EE004.png")
knitr::include_graphics("fig/pixel.png")
knitr::include_graphics("fig/hydrograph_08EE003.png")
```

## Morice River

The Morice River watershed drains 4,379km^2^ of Coast Mountains and Interior Plateau in a generally south-eastern direction. The Morice River is an 8th order stream that flows approximatley 80km from Morice Lake to the confluence with the upper Bulkley River just north of Houston. Major tributaries include the Nanika River, the Atna River, Gosnell Creek and the Thautil River. There area numerous large lakes situated on the south side of the watershed including Morice Lake, McBride Lake, Stepp Lake, Nanika Lake, Kid Price Lake, Owen Lake and others. There is one active hydrometric station on the mainstem of the Morice River near the outlet of Morice Lake and one historic station that was located at the mouth of the river near Houston that gathered data in 1971 only [@canada2024NationalWater]. An estimate of mean annual discharge for the one year of data available for the Morice near it's confluence with the Bulkley River is `r round(fasstr::calc_longterm_mean(station_number = "08ED003")$LTMAD,0)` m^3^/s. Mean annual discharge is estimated at `r round(fasstr::calc_longterm_mean(station_number = "08ED002")$LTMAD,0)` m^3^/s at station 08ED002 located near the outlet of Morice Lake. Flow patterns are typical of high elevation watersheds influenced by coastal weather patterns which receive large amounts of winter precipitation as snow in the winter and large precipitation events in the fall. This leads to peak levels of discharge during snowmelt, typically from May to July with isolated high flows related to rain and rain on snow events common in the fall (Figures \@ref(fig:hydrology-plot2) - \@ref(fig:hydrology-stats3)).

<br>

```{r, eval=FALSE}
sfpr_create_hydrograph("08ED002")
```

```{r, eval=FALSE}
sfpr_create_hydrograph("08ED003")
```

```{r hydrology-plot2, fig.cap = 'Left: Hydrograph for Morice River near Houston (Station #08ED003 - 1971 data only). Right: Hydrograph for Morice River near outlet of Morice Lake (Station #08ED002).', fig.show="hold", out.width= c("49.5%","1%","49.5%"), eval=T}
knitr::include_graphics("fig/hydrograph_08ED003.png")
knitr::include_graphics("fig/pixel.png")
knitr::include_graphics("fig/hydrograph_08ED002.png")
```

## Zymoetz River 

The Zymoetz River (known locally as the Copper River) watershed is an eighth order stream that drains an area of 3026km^2^ in a generally westerly direction. It is considered a major tributary of the Skeena River, as it contributes approximately 10% of the flow. The headwater lakes are located approximately 20km southwest of Smithers, and they include Aldrich, Dennis and McDonell Lakes. The upper and lower portions of the watershed are accessed via logging roads off of Highway 16 from Smithers and Terrace, respectively. Access to the middle watershed is difficult due to road wash out. The Zymoetz River flows roughly 120km, starting just west of Hudson Bay mountain near Smithers and ending at the confluence of the Skeena River, approximately 8km north-east of Terrace. Elevations in the watershed range from 120m at the confluence, to 2740m in the Howson Range. The Duthie mine operated on the south-west slope of Hudson Bay Mountain during the 1930's and 1950's, and reports have documented contaminated streams and lakes in the surrounding area [@gottesfeld_etal2002ConservingSkeena]. The lower end of the Zymoetz watershed has seen a significant reduction in riparian habitat due to fires, forest development practices, pipe line and road construction [@gottesfeld_etal2002ConservingSkeena]. Snowmelt plays a big role in controlling the stream hydrology, with a mean annual discharge estimated at `r round(fasstr::calc_longterm_mean(station_number = "08EF005")$LTMAD,0)` m^3^/s at station 08EF005 located near Smithers. Peak discharge happens in May to early June, which is typical of a high elevation watershed like this (Figures \@ref(fig:hydrology-plot3) - \@ref(fig:hydrology-stats4)).

<br>

```{r, eval=FALSE}
sfpr_create_hydrograph("08EF005")
```

```{r hydrology-plot3, fig.cap = 'Zymoetz River Above O.k. Creek (Station #08EF005 - Lat 54.49363 Lon -128.32466). Available mean daily discharge data from 1963 to 2021.', fig.show="hold", eval=T}
knitr::include_graphics("fig/hydrograph_08EF005.png")
```

### Kispiox River 

The Kispiox River watershed is a seventh order stream that drains an area of 2100km^2^ in a south east direction. It is a large tributary of the Skeena River, contributing approximately 9% of its flow. It flows 140km to the confluence of the Skeena River, near Kispiox Village. Elevations in the watershed range from 200m at the mouth to as high as 2090m on Kispiox Mountain. The mainstream of the Kispiox is fed mainly by glacier melt and high elevation snow melt. Swan and Stephens Lakes (located in the upper watershed) are important sockeye systems. Swan Lake drains via Club Lake into Stephens Lake which in turn flows via Stephens Creek into the mainstem of the Kispiox River. Some of the biggest threats to aquatic ecosystems in the Kispiox valley are reported as erosion, obstructions, sedimentation, and altered water yield. The upper third of the Kispiox watershed (upstream of the Nangeese River) is well protected from development by the Swan Lake Kispiox River Provincial Park and because it contains few roads with little forestry development [@gottesfeld_etal2002ConservingSkeena]. The Kispiox River has a mean annual discharge estimated at `r round(fasstr::calc_longterm_mean(station_number = "08EB004")$LTMAD,0)` m^3^/s at station 08EB004 located near Hazelton. Peak discharge happens in May and June as a result of the spring snowmelt (Figures \@ref(fig:hydrology-plot4) - \@ref(fig:hydrology-stats5)).

<br>

```{r, eval=FALSE}
sfpr_create_hydrograph("08EB004")
```

```{r hydrology-plot4, fig.cap = 'Kispiox River Near Hazelton (Station #08EB004 - Lat 55.43385 Lon -127.71616). Available mean daily discharge data from 1963 to 2022.', fig.show="hold", eval=T}
knitr::include_graphics("fig/hydrograph_08EB004.png")
```


## Kitsumkalum River

The Kitsumkalum River is a sixth order stream that flows east from the Coast Mountains to Kitsumkalum lake then south to Terrace where it joins the Skeena River, draining an area of 2289km^2^. Major tributaries to the Kitsumkalum River include the Cedar River, Nelson River, Mayo Creek, Goat Creek, Lean-To Creek and Deep Creek [@mcelhanney2022KitsumkalumRiver]. Peak flows occur in May-June from snow melt with subsequent peaks the fall from rain events [@mcelhanney2022KitsumkalumRiver]. There is one hydrometric station below Kitsumkalum lake which has been active since 2018, and has a mean annual discharge of `round(fasstr::calc_longterm_mean(station_number = "08EG019")$LTMAD,0)`m^3^/s (Figures \@ref(fig:hydrology-plot5) - \@ref(fig:hydrology-stats6). From 1929-1954, there was a hydrometric station near Terrace, which estimated the mean annual discharge to be `r round(fasstr::calc_longterm_mean(station_number = "08EG006")$LTMAD,0)`m^3^/s.


<br>

The Kitsumkalum River watershed has been highly impacted by logging. Many of the tributaries to the Kitsumkalum River have altered channel morphology, increased bedload movement, bank failures, sediment loading, and debris accumulation [@gottesfeld_rabnett2007SkeenaFish]. 

<br>

There has been a significant amount of work done to enhance salmon populations within the watershed. The SkeenaWild Conservation Trust is conducting riparian restoration surveys on several tributaries to the Kitsumkalum River, including Willow Creek, Spring Creek, Lean-To Creek, and Deep Creek [@healthywatershedsinitiative2021RiparianRestoration]. The Deep Creek Hatchery, operated by the Terrace Salmonid Enhancement Society, has been supporting Kitsumkalum River chinook populations since 1984 [@gottesfeld_rabnett2007SkeenaFish]. Additionally, there is a small groundwater facility for the incubation and rearing coho and chum, run by the Kitsumkalum First Nation [@gottesfeld_rabnett2007SkeenaFish]. In 2000 The Clear Creek Eastern Side Channel was constructed to enhance juvenile rearing habitat and adult spawning habitat for coho salmon on Clear Creek, a tributary to the Kitsumkalum River, however the site has not been maintained and beaver activity has obstructed fish accessibility to much of the channel [@elmer2021Initialassessment]. 

```{r, eval=FALSE}
sfpr_create_hydrograph("08EG019")
```

```{r hydrology-plot5, fig.cap = 'Kitsumkalum River Below Alice Creek (Station #08EG019 - Lat 54.6793 Lon -128.74396). Available mean daily discharge data from 2018 to 2022.', fig.show="hold", eval=T}
knitr::include_graphics("fig/hydrograph_08EG019.png")
```


## Fisheries

In 2004, @ibmbusinessconsultingservices2006ValuationWild estimated the value of Skeena Fisheries at an annual average of \$110 million dollars. The Bulkley-Morice watershed is an integral part of the salmon production in the Skeena drainage and supports an internationally renown steelhead, chinook and coho sport fishery [@tamblyn2005PlanConserve].


### Bulkley River

Traditionally, the salmon stocks passing through and spawning in the greater Bulkley River were the principal food source for the Gitxsan and Wet’suwet’en people living there [@wilson_rabnett2007FishPassage].  Anadromous lamprey passing through and spawning in the upper Bulkley River were traditionally also an important food source for the Wet'suwet'en (@gottesfeld_rabnett2007SkeenaFish; pers comm. Mike Ridsdale, Environmental Assessment Coordinator, Office of the Wet'suwet'en).  @gottesfeld_rabnett2007SkeenaFish report sourceing information from @departmentoffisheriesandoceans1991Fishhabitat that principal spawning areas for chinook in the Neexdzii Kwah include the mainstem above and below Buck and McQuarrie Creeks, between Cesford and Watson Creeks, and the reaches upstream and downstream of Bulkley Falls.

<br>

Renowned as a world class recreational steelhead and coho fishery, the greater Bulkley River receives some of the heaviest angling pressure in the province. In response to longstanding angler concerns with respect to overcrowding, quality of experience and conflict amongst anglers, an Angling Management Plan was drafted for the river following the initiation of the Skeena Quality Waters Strategy process in 2006 and an extensive multi-year consultation process. The plan introduces a number of regulatory measures with the intent to provide Canadian resident anglers with quality steelhead fishing opportunities. Regulatory measures introduced with the Angling Management Plan include prohibited angling for non-guided non-resident aliens on Saturdays and Sundays, Sept 1 - Oct 31 within the Bulkley River, angling prohibited for non-guided non-resident aliens on Saturdays and Sundays, all year within the Suskwa River and angling prohibited for non-guided non-resident aliens Sept 1 - Oct 31 in the Telkwa River. The Neexdzii Kwah is considered Class II water and there is no fshing permitted upstream of the Morice/Bulkley River Confluence [@flnro2013BulkleyRiver; @flnro2013OverviewAngling; @flnrord2019FreshwaterFishing].

<br>

#### Upper Bulkley Falls

A detailed field assessment and write up regarding the upper Bulkley falls was conducted as part of fish passage restoration in the watershed - is presented in @irvine2021BulkleyRiver with a condensed summary here. The site was assessed on October 28, 2021 by Nallas Nikal, B.i.T, and Chad Lewis, Environmental Technician. The top of the falls is located at 11U.678269.6038266 at an elevation of 697m approximatley 11.3km downstream of Bulkley Lake and upstream of Ailport Creek.  Within the Bulkley River immediately below the 12 - 15m high bedrock falls, the channel width was 17.4m and the wetted width was 15.6m. Two channels comprised the falls. The primary channel was 20m long, had a channel/wetted width of 8.5m, a 16% grade and water depths ranging from 35 - 63cm.  The secondary channel was 25m long, with channel/wetted widths of 7.5m, a grade of 12% and water depths ranging from 3 - 13cm [@irvine2021BulkleyRiver].

<br>

@dyson1949BulkleyFalls and @stokes1956UpperBulkley report substantial use of habitat above Bulkley Falls by steelhead, chinook, coho and sockeye utilization in the past (pre-1950) based on spawning reports.  Both authors concluded that the Bulkley Falls pose a partial obstruction to migrating fish based on flow levels. Chinook, which migrate early in the summer when water levels are high, have been noted as able to ascend the falls in normal to high water years and in high water years it was thought that coho and steelhead could ascend.  @gottesfeld_rabnett2007SkeenaFish report that the falls are almost completely impassable to all salmon during low water flows.  @stokes1956UpperBulkley reports that there was high value spawning habitat located within the first 3km of the Neexdzii Kwah from the outlet of Bulkley Lake.

<br>

@wilson_rabnett2007FishPassage reported that approximately 11.3 km downstream of the Bulkley Lake outlet and just upstream of Watson Creek, the upper Bulkley falls is an approximately 4m high narrow rock sill that crosses the Neexdzii Kwah, producing a steep cascade section. This obstacle to fish passage is recorded as an almost complete barrier to fish passage for salmon during low water flows. @wilson_rabnett2007FishPassage also reported that coho have not been observed beyond the falls since 1972. 


```{r fig-dfo-sad-tr1, fig.cap = "Fisheries and Oceans Canada stock assessment data for the Bulkley River - Upper.  Data is filtered to only include records with total return to river data.", eval= FALSE}

dfo_sad_raw %>%
  ldfo_sad_plot_line("BULKLEY RIVER - UPPER", "total_return_to_river", "species", "analysis_yr", col_group_exclude = "Coho")
```


```{r fig-dfo-sad-nad1, fig.cap = "Fisheries and Oceans Canada stock assessment data for the Bulkley River - Upper.  Data is filtered to only include records with natural adult spawners data.", eval = FALSE}

dfo_sad_raw %>%
  ldfo_sad_plot_line("BULKLEY RIVER - UPPER", "natural_adult_spawners", "species", "analysis_yr", col_group_exclude = "Coho")

```



### Morice River

Detailed reviews of Morice River watershed fisheries can be found in @bustard_schell2002ConservingMorice, @gottesfeld_etal2002ConservingSkeena, @schell2003BriefOverview, @gottesfeld_rabnett2007SkeenaFish, and @ilmb2007MoriceLand with a comprehensive review of water quality by @oliver2018Analysiswater Overall, the Morice watershed contains high fisheries values as a major producer of chinook, pink, sockeye, coho and steelhead.

### Zymoetz River

Within the Zymoetz Watershed, there are many areas with high fishery values. Steelhead are the most extensively documented fish species in the Zymoetz River watershed. Adults enter the river from July to November and then go on to spawn the following year in late spring to early summer. The Zymoetz River is a relatively steep system. Two canyons are located 6.4 and 19.6 kilometers upstream of the Skeena River confluence. These canyons make access to the Zymoetz difficult for pink and chum salmon [@gottesfeld_etal2002ConservingSkeena]. The Zymoetz River is renowned for its aggressive steelhead that have been known to take flies or lures. There is a 50km stretch upstream of Limonite Creek that's very remote and offers high quality fishing opportunities for anglers [@flnrord2013ZymoetzRiver].

<br>

Traditional First Nations use of the upper Zymoetz River watershed by the Gitxsan and Wet'suwet'en people differed between community sites, residences, and fish houses, and was large and diverse. From the upper to lower Zymoetz River and to the Skeena River, a significant ancient grease trail connected, with a branch track forking through Limonite Creek and flowing down the Telkwa River. The fishery used a weir at the mouth of McDonell Lake and spears at Six Mile Flats, near Dennis Lake. There is no information on native fisheries on the lower Zymoetz River. The Zymoetz is considered to be one of the top ten steelhead rivers in BC [@gottesfeld_etal2002ConservingSkeena].



### Kispiox River

Kispiox River salmon are a important food source and cultural symbol for the Gitxsan people with sockeye and coho historically the two most significant species. Gitangwalk and Lax Didax, two significant villages that were both abandoned in the early 1900s, were situated on the Kispiox in such a way as to block the sockeye and coho salmon's upstream migration to the Upper Kispiox River spawning grounds providing opportunities to gather and preserve a significant amount of high-quality food over relatively short time periods [@gottesfeld_etal2002ConservingSkeena]. The 100 km of mainstem and 300km of tributary streams in the Kispiox River Watershed are considering high value fish habitat supporting migration, spawning and rearing for many fish species. The Kispiox fisheries supports both recreational and commercial fishing while also enhancing the ecology, nutrient regime, and structural diversity of the drainage. Since 1992, sockeye and coho escapements from the Kispiox Watershed have been documented by the Gitxsan Watershed Authorities as they creates strong cultural, economic, and symbolic ties for the local communities [@gottesfeld_etal2002ConservingSkeena].


### Kitsumkalum River

The Kitsumkalum River is an important waterway for all species of salmon. It is one of the three main chinook producing rivers in the Skeena watershed and supports all five species of pacific salmon, steelhead, and other resident trout and char species [@mcelhanney2022KitsumkalumRiver]. Most notably, the Kitsumkalum River has consistently produced the largest-bodied chinook in the Skeena Watershed, as well as on most of the Pacific coast [@gottesfeld_rabnett2007SkeenaFish]. The watershed supports strong recreational coho, steelhead, and chinook fishing. Kitsumkalum salmon also play an important role in the culture and economy of the Kitsumkalum Band [@gottesfeld_rabnett2007SkeenaFish].   

### Salmon Stock Assessment Data

Fisheries and Oceans Canada stock assessment data was accessed via the [NuSEDS-New Salmon Escapement Database System](https://open.canada.ca/data/en/dataset/c48669a3-045b-400d-b730-48aafe8c5ee6)
through the [Open Government Portal](https://open.canada.ca/en). A brief memo on the data extraction process is available [here](http://htmlpreview.github.io/?https://github.com/NewGraphEnvironment/restoration_wedzin_kwa_2024/blob/main/memos/dfo_stock_assess.html).


```{r stock-assess-dat-all, results="asis", echo=FALSE, eval= FALSE}

my_caption <- "Fisheries and Oceans Canada stock assessment data for select watershed groups in the Skeena watershed.  Data can be filtered to specific waterbodies, columns can be dragged to reorder and filtered/reordered table can be exported to csv/excel."

# not the results="asis", echo=FALSE in the chunk header
ltab_caption()

dfo_sad_tr <- readr::read_csv('data/inputs_raw/All Areas NuSEDS.csv') %>% 
  # dplyr::filter(!is.na(total_return_to_river)) %>% 
  arrange(species, analysis_yr) %>% 
  dplyr::select(waterbody,
                species, 
                analysis_yr, 
                total_return_to_river, 
                start_spawn_dt_from,
                peak_spawn_dt_from,
                end_spawn_dt_from, 
                accuracy,	
                precision,	
                index_yn,	
                # no data here
                # reliability,	
                estimate_stage,	
                estimate_classification,	
                no_inspections_used,	
                estimate_method) |> 
  janitor::clean_names(case = "title") 

dfo_sad_tr |> 
  my_dt_table()

```



### Fish Species

Fish species recorded in the Morice, Bulkley, Zymoetz, Kispiox, and Kitsumkalum Rivers watershed groups are detailed in Table \@ref(tab:fiss-species-table) [@data_fish_obs]. Coastal cutthrout trout and bull trout are considered of special concern (blue-listed) provincially. Summaries of some of the Skeena fish species life history, biology, stock status, and traditional use are documented in @schell2003BriefOverview, @wilson_rabnett2007FishPassage, @gottesfeld_etal2002ConservingSkeena and @officeofthewetsuweten2013Wetsuwet. @wilson_rabnett2007FishPassage discuss chinook, pink, sockeye, coho, steelhead and indigenous freshwater Bulkley River fish stocks within the context of key lower and upper Bulkley River habitats such as the Suskwa River, Station Creek, Harold Price Creek, Telkwa River and Buck Creek. Key areas within the upper Bulkley River watershed with high fishery values, documented in @schell2003BriefOverview, are the upper Bulkley mainstem, Buck Creek, Dungate Creek, Barren Creek, McQuarrie Creek, Byman Creek, Richfield Creek, Johnny David Creek, Aitken Creek and Emerson Creek.

<br>

Some key areas of high fisheries values for chinook, sockeye and coho are noted in @bustard_schell2002ConservingMorice as McBride Lake, Nanika Lake, and Morice Lake watersheds. A draft gantt chart for select species in the Morice River and Bulkley River watersheds was derived from reviews of the aforementioned references and is included as Figure \@ref(fig:fish-gantt-morice). The data is considered in draft form and will be refined over the spring and summer of 2021 with local fisheries technicians and knowledge holders during the collaboratory assessment planning and fieldwork activities planned.

<br>

In the 1990's the Morice River watershed, @gottesfeld_rabnett2007SkeenaFish estimated that chinook comprised 30% of the total Skeena system chinook escapements. It is estimated that Morice River coho comprise approximatley 4% of the Skeena escapement with a declining trend noted since the 1950 in @gottesfeld_rabnett2007SkeenaFish. Coho spawn in major tributaries and small streams ideally at locations where downstream dispersal can result in seeding of prime off channel habitats including warm productive sloughs and side channels. Of all the salmon species, coho rely on small tributaries the most [@bustard_schell2002ConservingMorice]. @bustard_schell2002ConservingMorice report that much of the distribution of coho into non-natal tributaries occurs during high flow periods of May - early July with road culverts blocking migration into these habitats.

```{r}
##### Chinook
#  In the 1990's Morice River watershed, @gottesfeld_rabnett2007SkeenaFish estimated that chinook comprised 30% of the total Skeena system chinook escapements. @buckwalter_kirsch2012Fishinventory have recorded juvenile chinook rearing in small non natal streams. 

# @buckwalter_kirsch2012Fishinventory have uvenile chinook have been recorded rearing in small non natal streams 


#It is estimated that Morice River coho comprise approximatley 4% of the Skeena escapement with a declining trend noted since the 1950 in @gottesfeld_rabnett2007SkeenaFish.  Coho spawn in major tributaries and small streams ideally at locations where downstream dispersal can result in seeding of prime off channel habitats including warm productive sloughs and side channels.  Of all the salmon species, coho rely on small tributaries the most [@bustard_schell2002ConservingMorice]. @bustard_schell2002ConservingMorice report that much of the distribution of coho into non-natal tributaries occurs during high flow periods of May - early July with road culverts blocking migration into these habitats.


```

<br>

Summaries of historical fish observations in the Bulkley River and Morice River watershed groups (n=4033), graphed by remotely sensed average gradient as well as measured or modelled channel width categories for their associated stream segments where calculated with `bcfishpass` and `bcfishobs` and are provided in Figures \@ref(fig:fish-plot-grad) - \@ref(fig:fish-plot-width).

`r if(gitbook_on){knitr::asis_output("<br>")} else knitr::asis_output("<br><br><br><br>")`

```{r fiss-species-table}
fiss_species_table <- readr::read_csv('data/inputs_extracted/fiss_species_table.csv')

fiss_species_table %>% 
  fpr::fpr_kable(caption_text = 'Fish species recorded in the Morice River, Bulkley River, Zymoetz River, Kispiox River, and Kitsumkalum River watershed groups.', 
                 footnote_text = 'COSEWIC abbreviations : 
                 SC - Special concern 
                 DD - Data deficient
                 NAR - Not at risk
                 E - Endangered
                 T - Threatened
                 
                 BC List definitions : 
                 Yellow - Species that is apparently secure 
                 Blue - Species that is of special concern
                 Exotic - Species that have been moved beyond their natural range as a result of human activity
                 ',
                 scroll = gitbook_on)
```

<br>

```{r fish-gantt-morice, fig.cap = 'Gantt chart for select species in the Morice River and Bulkley River watersheds.  To be updated in consultation with local fisheries techicians and knowledge holders.', eval=T}
gantt_raw <- read_csv("data/inputs_raw/fish_species_life_history_gantt.csv")


##start with just the morice to keep it simple
# ungroup()
##start with just the morice to keep it simple
gantt <- gantt_raw %>%
  select(Species,
         life_stage,
         morice_start2,
         morice_end2) %>%
  filter(
    life_stage != 'Rearing' &
      life_stage != 'Upstream fry migration' &
      !is.na(life_stage),
    !is.na(morice_start2)
  )%>%
  mutate(
    morice_start2 = lubridate::as_date(morice_start2),
    morice_end2 = lubridate::as_date(morice_end2),
    life_stage = factor(life_stage, levels =
                          c('Migration', 'Overwintering', 'Spawning', 'Incubation', 'Emergence', 'Outmigration')),
    life_stage = forcats::fct_rev(life_stage) ##last line was upside down!
  ) %>%
  filter(life_stage != 'Overwintering')


##make a plot
ggplot(gantt, aes(xmin = morice_start2,
                  xmax = morice_end2,
                  y = life_stage,
                  color = life_stage)) +
  geom_linerange(size = 2) +
  labs(x=NULL, y=NULL)+
  # theme_bw()+
  ggdark::dark_theme_bw(base_size = 11)+
  theme(legend.position = "none")+
  scale_x_date(date_labels = "%B")+
  facet_wrap(~Species, ncol = 1)
```

<br>

```{r fish-fiss-summary, eval=T}
# fiss_sum <- readr::read_csv(file = paste0(getwd(), '/data/extracted_inputs/fiss_sum.csv'))
fiss_sum_grad <- readr::read_csv(file = 'data/inputs_extracted/fiss_sum_grad.csv')
fiss_sum_width <- readr::read_csv(file = 'data/inputs_extracted/fiss_sum_width.csv')

# A summary of historical westslope cutthrout trout observations in the Elk River watershed group by average gradient category of associated stream segment is provided in Figure \@ref(fig:fish-wct-bar). Of `r wct_elkr_grad %>% filter(gradient_id == 3) %>% pull(total)` observations, `r wct_elkr_grad %>% filter(gradient_id == 3) %>% pull(Percent) + wct_elkr_grad %>% filter(gradient_id == 5) %>% pull(Percent) + wct_elkr_grad %>% filter(gradient_id == 8) %>% pull(Percent)`% were within stream segments with average gradients ranging from 0 - 8%.  A total of `r wct_elkr_grad %>% filter(gradient_id == 3) %>% pull(Percent)`% of historic observations were within stream segments with gradients between 0 - 3%, `r wct_elkr_grad %>% filter(gradient_id == 5) %>% pull(Percent)`% were within stream segments with gradients ranging from 3 - 5% and `r wct_elkr_grad %>% filter(gradient_id == 5) %>% pull(Percent)`% were within stream segments with gradients between 5 - 8% [@data_fish_obs; @norris2020bcfishobs]. 

```

```{r fish-plot-grad, out.width = photo_width, fig.cap= 'Summary of historic salmonid observations vs. stream gradient category for the Bulkley River watershed group.', eval=T}
##bar graph
plot_grad <- fiss_sum_grad %>% 
  filter(gradient_id != 99) %>% 
  ggplot(aes(x = Gradient, y = Percent)) +
  geom_bar(stat = "identity")+
  facet_wrap(~species_code, ncol = 2)+
  ggdark::dark_theme_bw(base_size = 11)+
  labs(x = "Average Stream Gradient", y = "Occurrences (%)")
plot_grad

```

<br>

```{r fish-plot-width, out.width = photo_width, fig.cap= 'Summary of historic salmonid observations vs. channel width category for the Bulkley River watershed group.', eval=T}
##bar graph
plot_width <- fiss_sum_width %>% 
  filter(!is.na(width_id)) %>%
  ggplot(aes(x = Width, y = Percent)) +
  geom_bar(stat = "identity")+
  facet_wrap(~species_code, ncol = 2)+
  ggdark::dark_theme_bw(base_size = 11)+
  labs(x = "Channel Width", y = "Occurrences (%)")
plot_width
```

<br>

```{r fish-plot-wshed, out.width = photo_width, fig.cap= 'Summary of historic salmonid observations vs. watershed size category for the Bulkley River watershed group.', eval=F}
##bar graph
fiss_sum_wshed_filter <- fiss_sum %>% 
  filter(upstream_area_ha < 5000) %>% 
  mutate(upstream_area_km = upstream_area_ha/100)

bin_1 <- 0
# bin_1 <- floor(min(fiss_sum_wshed_filter$upstream_area_ha, na.rm = TRUE)/5)*5
bin_n <- ceiling(max(fiss_sum_wshed_filter$upstream_area_km, na.rm = TRUE)/5)*5
bins <- seq(bin_1,bin_n, by = 5)

plot_wshed_hist <- ggplot(fiss_sum_wshed_filter, aes(x=upstream_area_km
                                           # fill=alias_local_name
                                           # color = alias_local_name
)) +
  geom_histogram(breaks = bins, 
                 position="identity", size = 0.75)+
  labs(x = "Upstream Watershed Area (km)", y = "Count Fish (#)") +
  facet_wrap(~species_code, ncol = 2)+
  # scale_color_grey() +
  # scale_fill_grey() +
  ggdark::dark_theme_bw(base_size = 11)+
  scale_x_continuous(breaks = bins[seq(1, length(bins), by = 2)])+
  # scale_color_manual(values=c("grey90", "grey60", "grey30", "grey0"))+
  # theme(axis.text.x = element_text(angle = 45, hjust = 1))+
  geom_histogram(aes(y=..density..), breaks = bins, alpha=0.5,
                 position="identity", size = 0.75)
plot_wshed_hist
```

<br>



```{r}
## Fish Passage Restoration Planning and Implementation

# As a result of high-level direction from the provincial government, a Fish Passage Strategic Approach protocol has been developed for British Columbia to ensure that the greatest opportunities for restoration of fish passage are pursued. A Fish Passage Technical Working Group has been formed to coordinate the protocol and data is continuously amalgamated within the Provincial Steam Crossing Inventory System (PSCIS). The strategic approach protocol involves a four-phase process as described in @fishpassagetechnicalworkinggroupFishPassageStrategic2014 :
# 
# -   Phase 1: Fish Passage Assessment -- Fish stream crossings within watersheds with high fish values are assessed to determine barrier status of structures and document a general assessment of adjacent habitat quality and quantity.
# -   Phase 2: Habitat Confirmation -- Assessments of crossings prioritized for follow up in Phase 1 studies are conducted to confirm quality and quantity of habitat upstream and down as well as to scope for other potential nearby barriers that could affect the practicality of remediation.
# -   Phase 3: Design -- Site plans and designs are drawn for priority crossings where high value fish habitat has been confirmed.
# -   Phase 4: Remediation -- Re-connection of isolated habitats through replacement, rehabilitation or removal of prioritized crossing structure barriers.


```



```{r}
##`r pscis_historic_phase1 %>% filter(watershed_group_code %ilike% 'BULK' & assessment_date < '2020-01-01') %>% nrow()`
### Bulkley River

# There is a rich history of fish passage restoration planning in the Bulkley River watershed group with not all the work documented in the PSCIS system. A non-exhaustive list of historic fish passage reports for the watershed includes @wilson_rabnett2007FishPassage, @mccarthy_fernando20152015Inventory,@smith2018AssessingBarriers @casselman_stanley2010BulkleyFulton and @irvine2018AnalysisPriority.
# 
# <br>
# 
# Review of the PSCIS database indicated that prior to 2021, 1665 assessments for fish passage (Phase 1) at crossing structures within the Bulkley River watershed group have been recorded in the PSCIS database [@moe2021PSCISAssessments]. No habitat confirmations are recorded in the PSCIS database [@moe2021PSCISHabitat]. Within the Bulkley River watershed group, a number of remediation projects have been completed over the years with backwatering works conducted on Toboggan Creek, Coffin Creek, Moan Creek, Johnny David Creek and potentially others. Three culvert replacements (with open bottom structures) in the watershed group have been tracked in PSCIS and include works on Barren Creek as well as two tributaries to Harold Prince Creek [@moe2021PSCISRemediation]. McDowell Creek at Highway 16 was replaced with a horizontally drilled baffled structure in 2017 and a design is currently being drafted for the Highway 16 crossing over Taman Creek (pers. comm. Kathryn Graham, Regional Manager Environmental Services - Ministry of Transportation and Infrastructure).
# 
# ## Morice river
# 
# Within the Morice River watershed group prior to 2021, 21 fish passage assessments (Phase 1) had been recorded in the PSCIS database [@moe2021PSCISAssessments]. At the time of reporting, no habitat confirmations had been recorded [@moe2021PSCISHabitat]. Two culvert replacements (with open bottom structures) in the watershed group have been tracked in PSCIS in the and include works on a tributary to the Morice River located at km 39.2 of the Morice River FSR and on bridge installation at km 4 of McBride Road on a tributary to McBride Lake [@moe2021PSCISRemediation].

```



```{r}
##`r pscis_historic_phase1 %>% filter(watershed_group_code %ilike% 'MORR' & assessment_date < '2020-01-01') %>% nrow()`
```

<!--chapter:end:0200-background.Rmd-->

# Methods


```{r set-up}
fish_col_permit_num <- "PG23-813101"

```

## Communicate Connectivity Issues 

### Engage Partners 

Engaging partners for ecosystem restoration initiatives is critical as it allows us to utilize available resources, tap
into different areas of expertise, and benefit from diverse perspectives through collaboration that leads to successful
outcomes. Engagement actions have included video conference calls, meetings, emails, presentations and phone calls.

### Collaborative GIS Environment 
Geographical Information Systems are essential for developing and communicating restoration plans as well as the reasons
they are required and how they are developed. Without the ability to visualize the landscape and the data that is used
to make decisions, it is difficult to conduct and communicate the need for restoration, the details of past and future
plans as well as and the potential results of physical works.

<br>

To facilitate the planning and implementation of restoration activities, a collaborative GIS environment has been
established using [QGIS](https://qgis.org/en/site/) and is served on the cloud using source code stored
[here](https://github.com/MerginMaps). This environment is intended to be a space where project team members can access,
view, and contribute to the amalgamation of background spatial data and the development of restoration as well as
monitoring for the project. The collaborative GIS environment allows users to view, edit, and analyze shared, up to date
spatial data on personal computers in an office setting as well as on phones and tablets in the field. At the time of
reporting, the environment was being used to develop and share maps, conduct spatial analyses, communicate restoration
plans to stakeholders as well as to provide a central place to store methodologies and tools for conducting field
assessments on standardized pre-developed digital forms. The platform can also be used to track the progress of
restoration activities and monitor changes in the landscape over time, helping encourage the record keeping of past and
future restoration activities in a coordinated manner.

<br>

The shared QGIS project was created using scripts currently kept in
[`dff-2022`](https://github.com/NewGraphEnvironment/dff-2022) with the precise calls to project creation scripts tracked
in the `project_creation_and_permissions.txt` document kept in the main QGIS project directory. Information about the scripts used for GIS project creation and updates can be viewed
[here](https://github.com/NewGraphEnvironment/dff-2022/tree/master/scripts/qgis) with outcomes of their use summarized
below:

  - Download and clip user specified layers from the [BC Data Catalogue](https://catalogue.data.gov.bc.ca/) as well as data layers stored in custom Amazon Web Services buckets for an area of interest defined by a list of watershed groups and load to a geopackage called `background_layers.gpkg` stored in the main directory of the project.  
  - A project directory is created to hold the spatial data and `QGIS` project information (ie. layer symbology and naming conventions, metadata, etc.).
  - Metadata for individual project spatial layers is kept in the `rfp_tracking` table within the `background_layers.gpkg` along with tables related to user supplied stream width/gradient inputs to `bcfishpass` to model potentially high value habitat that is accessible to fish species of interest. 
  
### Issue Tracking
"Issues" logged on the online github platform are effective ways to track tasks, enhancements, and bugs related to project components.
They can be referenced with the scripts, text and actions used to address them by linking documentation to the issues with text comments
or programatically through `git` commit messages.  Issues for this project are kept [here](paste0('https://github.com/NewGraphEnvironment/',params$job_name,'/issues')).

### Mapping

<!-- Project specific -->
<!-- Maps incorporating the sa'ba (bull trout) spawning and rearing habitat model for the Parsnip River, Carp Lake and -->
<!-- Crooked River watershed groups are served online and were generated using reproducible open source workflows developed -->
<!-- by Hillcrest Geographics.  -->

The workflows to produce the georeferenced  `pdf` maps include using a QGIS layer file
defining and symbolizing all layers required and are continuously evolving. At the time of reporting - mapping scripts
and associated layer file were kept under version control within `bcfishpass` [here](https://github.com/smnorris/bcfishpass/tree/main/qgis).
Loading the QGIS layer file within a QGIS project, allows load and representation of all map component layers provided
the user points to a postgresql database populated via `bcfishpass` outputs.


```{r}
### Interactive Dashboard

# We built an interactive dashboard to allow users to conduct background research and planning to facilitate communication and enable future field surveys in the Peace Region. The interactive interface allows screening of previously inventoried as well as modelled stream crossing locations based on watershed group as well as the likely quantity and quality of bull trout rearing and spawning habitat modelled upstream. Historic assessment data including photos of sites can be viewed when present and through the dashboard users can download csv results and associated georeferenced field maps to facilitate field surveys. The dashboard was built using `R` packages `crosstalk` [@cheng_sievert2022Crosstalk], `DT` [@xie_etal2022interfaceDataTables] and `Leaflet` [@cheng_etal2022InterfaceLeaflet].
```



#### Habitat Modelling

Through this initiative, other SERNbc led initiatives [@irvine2021BulkleyRiver; @irvine2022BulkleyRiver], multi-decade
direction from the Provincial Fish Passage Remediation Program and connectivity restoration planning conducted by
Canadian Wildlife Federation and others [@mazany-wright_etal2021BulkleyRiver; @irvine2022ElkRiver], `bcfishpass` has
been designed to prioritize potential fish passage barriers for assessment or remediation. The software is under
continual development and has been designed and constructed by @norris2021smnorrisbcfishpass using sql and python based
shell script libraries to generate a simple model of aquatic habitat connectivity.  The model identifies natural
barriers (ex. steep gradients for extended distances) and hydroelectric dams to classify the accessibility upstream
by fish [@norris2021smnorrisbcfishpass]. On potentially accessible streams, scripts identify known barriers (ex.
waterfalls >5m high) and additional anthropogenic features which are primarily road/railway stream crossings (i.e.
culverts) that are potentially barriers. To prioritize these features for assessment or remediation, scripts report on
how much modelled potentially accessible aquatic habitat the barriers may obstruct. The model can be refined with
numerous parameters including known fish observations upstream of identified barriers and for each crossing location,
the area of lake and wetland habitat upstream, species documented upstream/downstream, and an estimate of watershed area
(on 2nd order and higher streams).  Furthermore, mean annual precipitation weighted to upstream watershed area, stream
discharge, and channel width can be collated using `bcfishpass`, `fwapg` and `bcfishobs`.  This information can be used
to provide an indication of the potential quantity and quality of habitat potentially gained should fish passage be
restored, by comparing to user defined thresholds for the aforementioned parameters.

 <br>

<!-- Project specific fish species at the end of this paragraph. -->
Regarding gradients, `bcfishpass` calculates the average gradient of BC Freshwater Atlas stream network lines at minimum 100m long intervals starting from the downstream end of the streamline segment and working upstream.  The network lines are broken into max gradient categories with new segments created if and when the average slope of the stream line segment exceeds user provided thresholds. For this phase of the project, the user provided gradient thresholds used to delineate "potentially accessible habitat" were based on estimated max gradients that rainbow trout (20%) and bull trout (25%) are likely to be capable of ascending.

<br>

Gradient, channel size and stream discharge are key determinants of channel morphology and subsequently fish distribution. High value rearing, overwintering, and spawning habitat preferred by numerous species/life stages of fish are often located within channel types that have relatively low gradients and large channel widths (also quantified by the amount of flow in the stream).

<br>

Following delineation of "potentially accessible habitat", the average gradient of each stream segment within habitat classified as below the 20% and 25% thresholds was calculated and summed within species and life stage specific gradient categories.  Average gradient of stream line segments can be calculated from elevations contained in the provincial freshwater atlas streamline dataset.

<br>

To obtain estimates of channel width upstream of crossing locations, where available, `bcfishpass` was utilized to pull average channel gradients from Fisheries Information Summary System (FISS) site assessment data [@moeStreamInventorySample] or PSCIS assessment data [@moe2021PSCISAssessments] and associate with stream segment lines. When both FISS and PSCIS values were associated with a particular stream segment, or multiple FISS channel widths are available a mean of the average channel widths was used.  To model channel width for 2nd order and above stream segments without associated FISS or PSCIS sites, first `fwapg` was used to estimate the drainage area upstream of the segment.  Then, rasters from ClimateBC [@wang_etal2012ClimateWNAHighResolution] were downloaded to a `postgresql` database, sampled for upstream watershed areas associated with each stream segment and a mean annual precipitation weighted by upstream watershed area was calculated. In early 2021, Bayesian statistical methods were developed to predict channel width in all provincial freshwater atlas stream segments where width measurements had not previously been measured in the field.  The model was based on the relationship between watershed area and mean annual precipitation weighted by upstream watershed area [@thorley_irvine2021ChannelWidtha].  In December of 2021, @thorley_irvine2021ChannelWidtha methods were updated using a power model derived by @finnegan_etal2005Controlschannel which relates stream discharge to watershed area and mean annual precipitation. Data (n = 24849) on watershed size, mean annual precipitation and measured channel width was extracted from the provincial freshwater atlas [@flnrord2021FreshwaterAtlasb;  @geobc2022FreshwaterAtlas], the BC Data Catalogue fisheries datasets [@moe2024StreamInventory; @moe2021PSCISAssessments] and @wang_etal2012ClimateWNAHighResolution utilizing `bcfishpass` [@norris2021smnorrisbcfishpass] and `fwapg` [@norris2021smnorrisfwapg]. Details of this analysis and subsequent outputs can be reviewed [here](https://www.poissonconsulting.ca/f/859859031) [@thorley_etal2021ChannelWidthb].

<br>

<!-- Project specific fish species in this paragraph. -->
`bcfishpass` and associated tools have been designed to be flexible in analysis, accepting user defined gradient, channel width and stream discharge categories [@moeStreamInventorySample].  Although currently in draft form, and subject to development revisions, gradient and channel width thresholds for habitat with the highest intrinsic value for a number of fish species in the Parsnip River watershed group have been specified and applied to model habitat upstream of stream crossing locations with the highest potential intrinsic value (Table \@ref(tab:tab-fish-spawning-rearing)). Definitions of modelling outputs for bull trout are presented in Table \@ref(tab:tab-bcfp-def).  Modelling of habitat for Arctic grayling, in the Peace region are planned for 2024-2025 with the work leveraging multiple other initiatives underway by SERNbc and others throughout British Columbia including work related to Arctic grayling habitat use and preference conducted by UNBC and others [@hagen_stamford2023ParsnipArctic; @bottoms_etal2023Criticalhabitats.



<br>

<!-- Turn on once tables.R has been run  -->
<!-- Project specific fish species in this code, must customize to repo -->
```{r tab-fish-spawning-rearing, eval=F}
#`r if(identical(gitbook_on, FALSE)){knitr::asis_output("<br><br><br>")}`
bcfishpass_spawn_rear_model %>%
  filter(species_code %in% c('BT','GR')) %>%
  mutate(Species = fishbc::fbc_common_name(species_code),
         spawn_gradient_max = round(spawn_gradient_max * 100 ,1),
         rear_gradient_max = round(rear_gradient_max * 100 ,1)) %>%
  select(Species,
         `Spawning Gradient  Max (%)`= spawn_gradient_max,
         `Spawning Width Min (m)` = spawn_channel_width_min,
         `Rearing Width Min (m)` = rear_channel_width_min,
         # `Spawning Width Max (m)` = spawn_channel_width_max,
         # `Spawning MAD Min (m3/s)` = spawn_mad_min,
         # `Spawning MAD Max (m3/s)` = spawn_mad_max,
         `Rearing Gradient Max (%)` = rear_gradient_max) %>%
         # `Rearing MAD Min (m3/s)` = rear_mad_min,
         # `Rearing MAD Max (m3/s)` = rear_mad_max,
         # `Rearing Wetland Multiplier` = rear_wetland_multiplier,
         # `Rearing Lake Multiplier` = rear_lake_multiplier) %>%
  t() %>%
  as_tibble(rownames = "row_names") %>%
  janitor::row_to_names(row_number = 1) %>%
  rename(Variable = Species) %>%
  fpr::fpr_kable(caption_text = 'Stream gradient and channel width thresholds used to model potentially highest value fish habitat.',
                 footnote_text = 'Models for RB, GR and KO are under a process of development and have not yet been released.  All models parameters are preliminary and subject to collaborative development.',
                 scroll = F,
                 scroll_box_height = '300px')

```


`r if(gitbook_on){knitr::asis_output("<br>")} else knitr::asis_output("\\newpage")`

<!-- This table has not been included in the most recent reports (skeena and peace 2023). Maybe because we now use 8.5% for ST rearing habitat, which is not what is referenced in this table (they said 7.5) -->
```{r tab-fish-spawning-rearing-references, eval = F}
# bcfishpass_spawn_rear_model_references <- readr::read_csv(file = 'data/width_modelling/model_spawning_rearing_habitat.csv')
bcfishpass_spawn_rear_model_references <- readr::read_csv(file = 'data/inputs_raw/model_spawning_rearing_habitat.csv')
  # select(species_code, contains('ref'), -contains(c('multiplier','mad')))

bcfishpass_spawn_rear_model_references %>%
  mutate(Species = fishbc::fbc_common_name(species_code)) %>%
  select(Species,
         `Spawning Gradient  Max (%)`= spawn_gradient_max,
         `Spawning Width Min (m)` = spawn_channel_width_min,
         # `Spawning Width Max (m)` = spawn_channel_width_max_ref,
         # `Spawning MAD Min (m3/s)` = spawn_mad_min,
         # `Spawning MAD Max (m3/s)` = spawn_mad_max,
         `Rearing Gradient Max (%)` = rear_gradient_max) %>%
         # `Rearing Wetland Multiplier` = rear_wetland_multiplier,
         # `Rearing Lake Multiplier` = rear_lake_multiplier) %>%
         # `Rearing MAD Min (m3/s)` = rear_mad_min,
         # `Rearing MAD Max (m3/s)` = rear_mad_max) %>%
  t() %>%
  as_tibble(rownames = "row_names") %>%
  janitor::row_to_names(row_number = 1) %>%
  rename(Variable = Species) %>%
  fpr::fpr_kable(caption_text = 'References for stream gradient and channel width thresholds used to model potentially highest value fish habitat. Preliminary and subject to revisions.',
                 footnote_text = 'The maximum gradient for steelhead rearing has been adjusted to 8.5% based on professional judgment, although references indicate 7.49%',
                 scroll = F)
```


<br>

<!-- Turn on once tables.R has been run  -->
```{r tab-bcfp-def, eval = F}
xref_bcfishpass_names %>%
  filter(id_side == 1) %>%
  arrange(id_join) %>%
  select(Attribute = report, Definition = column_comment) %>%
  fpr::fpr_kable(caption_text = 'bcfishpass outputs and associated definitions',
                 footnote_text = 'Bull trout model uses a gradient threshold of maximum 25% to determine if access if likely possible',
                 scroll = gitbook_on)
```


```{r tablethreshaverage, eval= F}
#to quantify upstream habitat potentially available for salmonids and facilitate stream line symbology based on stream morphology.

# while high gradient sections typically  present  upstream  migration  barriers  and  less  available  habitat.  Additionally, the size of the stream (indicated by channel width) is an important determinant for habitat suitability for different species as well as specific life stages of those species. 

# `bcfishpass` was used to categorize and sum potentially accessible stream segments in the study area watersheds within gradient and width categories for each stream segment. 
# (0 - 3%, 3 - 5%, 5 - 8%, 8 - 15%, 15 - 20%) with these outputs further amalgamated to summarize and symbolize potential upstream habitat in three categories: riffle/cascade (0 - 5%), step-pool (5 - 15%) and step-pool very steep (15-20%) (Table \@ref(tab:tablethreshaverage)).  


#threshold and average gradient table
table_thresh_average <- tibble::tibble(`Gradient` = c('0 - 5%', '5 - 15%', '15 - 20%', '>20%'),
                                       `Channel Type` = c('Riffle and cascade pool', 'Step pool', 'Step pool - very steep', 'Non fish habitat'))

table_thresh_average %>% 
    fpr::fpr_kable(caption_text = 'Stream gradient categories (threshold and average) and associated channel type.')

```


## Fish Passage Assessments

In the field, crossings prioritized for follow-up were first assessed for fish passage following the procedures outlined in “Field Assessment for Determining Fish Passage Status of Closed Bottomed Structures” [@fish_passage_assessments]. The reader is referred to [@fish_passage_assessments] for detailed methodology.  Crossings surveyed included closed bottom structures (CBS), open bottom structures (OBS) and crossings considered “other” (i.e. fords).  Photos were taken at surveyed crossings and when possible included images of the road, crossing inlet, crossing outlet, crossing barrel, channel downstream and channel upstream of the crossing and any other relevant features.  The following information was recorded for all surveyed crossings: date of inspection, crossing reference, crew member initials, Universal Transverse Mercator (UTM) coordinates, stream name, road name and kilometer, road tenure information, crossing type, crossing subtype, culvert diameter or span for OBS, culvert length or width for OBS.  A more detailed “full assessment” was completed for all closed bottom structures and included the following parameters: presence/absence of continuous culvert embedment (yes/no), average depth of embedment, whether or not the culvert bed resembled the native stream bed, presence of and percentage backwatering, road fill depth, outlet drop, outlet pool depth, inlet drop, culvert slope, average downstream channel width, stream slope, presence/absence of beaver activity, presence/absence of fish at time of survey, type of valley fill, and a habitat value rating.  Habitat value ratings were based on channel morphology, flow characteristics (perennial, intermittent, ephemeral), fish migration patterns, the presence/absence of deep pools, un-embedded boulders, substrate, woody debris, undercut banks, aquatic vegetation and overhanging riparian vegetation (Table \@ref(tab:tab-hab-value)).

<br>



```{r tab-hab-value}
fpr_table_habvalue %>%
  knitr::kable(caption = 'Habitat value criteria (Fish Passage Technical Working Group, 2011).', booktabs = T) %>%
    kableExtra::column_spec(column = 1, width_min = '1.5in') %>%
    kableExtra::kable_styling(c("condensed"), full_width = T, font_size = font_set)

```

`r if(gitbook_on){knitr::asis_output("<br>")} else knitr::asis_output("\\pagebreak")`



Fish passage potential was determined for each stream crossing identified as a closed bottom structure as per @fish_passage_assessments.  The combined scores from five criteria: depth and degree to which the structure is embedded, outlet drop, stream width ratio, culvert slope, and culvert length were used to screen whether each culvert was a likely barrier to some fish species and life stages (Table \@ref(tab:tab-barrier-scoring), Table \@ref(tab:tab-barrier-result)). These criteria were developed based on data obtained from various studies and reflect an estimation for the passage of a juvenile salmon or small resident rainbow trout [@clarkinNationalInventoryAssessment2005 ;@bellFisheriesHandbookEngineering1991; @thompsonAssessingFishPassage2013]. For crossings determined to be potential barriers or barriers based on the data, a culvert fix and recommended diameter/span was proposed. 

<br>

```{r tab-barrier-scoring, eval=T}
tab <- as_tibble(t(fpr_table_barrier_scoring)) %>%
  mutate(V4 = names(fpr_table_barrier_scoring)) %>%
  select(V4, everything()) %>%
  janitor::row_to_names(1) %>%  ##turn the table sideways
  mutate(Risk = case_when(Risk == 'Value' ~ '  Value',
                          T ~ Risk))

tab %>%
  fpr::fpr_kable(caption_text = 'Fish Barrier Risk Assessment (MoE 2011).', scroll = F)

```

<br>


```{r tab-barrier-result}
fpr_table_barrier_result %>%
  fpr::fpr_kable(caption_text = 'Fish Barrier Scoring Results (MoE 2011).', scroll = F)

```


<br>

<!-- Project specific fish species in this paragraph. -->
Habitat gain indexes are the quantity of modelled habitat upstream of the subject crossing and represents an estimate of habitat gained with remediation of fish passage at the crossing.  For this project, a gradient threshold between accessible and non-accessible habitat was set at 25% (for a minimimum length of 100m) and intended to represent the maximum gradient of which the strongest swimmers of anadromous species (bull trout) are likely to be able to migrate upstream.  This is the amount of habitat upstream of each crossing less than 25% gradient before a falls of height >5m - as recorded in @ProvincialObstaclesFish or documented in other `bcfishpass` online documentation. For Phase 2 - habitat confirmation sites, conservative estimates of the linear quantity of habitat to be potentially gained by fish passage restoration, bull trout rearing maximum gradient threshold (10.5%) was used. To generate estimates for area of habitat upstream (m^2^), the estimated linear length was multiplied by half the downstream channel width measured (overall triangular channel shape) as part of the fish passage assessment protocol. Although these estimates are not generally conservative, have low accuracy and do not account for upstream stream crossing structures they allow a rough idea of the best candidates for follow up.

<br>


Potential options to remediate fish passage were selected from @fish_passage_assessments and included:

 + Removal (RM) - Complete removal of the structure and deactivation of the road.
 + Open Bottom Structure (OBS) - Replacement of the culvert with a bridge or other open bottom structure.  Based on consultation with FLNR road crossing engineering experts, for this project we considered bridges as the only viable option for OBS type .
 + Streambed Simulation (SS) - Replacement of the structure with a streambed simulation design culvert.  Often achieved by embedding the culvert by 40% or more. Based on consultation with FLNR engineering experts, we considered crossings on streams with a channel width of <2m and a stream gradient of <8% as candidates for replacement with streambed simulations.
 + Additional Substrate Material (EM) - Add additional substrate to the culvert and/or downstream weir to embed culvert and reduce overall velocity/turbulence.  This option was considered only when outlet drop = 0, culvert slope <1.0% and stream width ratio < 1.0.
 + Backwater (BW) - Backwatering of the structure to reduce velocity and turbulence. This option was considered only when outlet drop < 0.3m, culvert slope <2.0%, stream width ratio < 1.2 and stream profiling indicates it would be effective..

 <br>

### Cost Estimates
Cost estimates for structure replacement with bridges and embedded culverts were generated based on the channel width, slope of the culvert, depth of fill, road class and road surface type. Road details were sourced from @flnrordForestTenureRoad2020 and @flnrordDigitalRoadAtlas2020 through `bcfishpass`. Interviews with Phil MacDonald, Engineering Specialist FLNR - Kootenay, Steve Page, Area Engineer - FLNR - Northern Engineering Group and Matt Hawkins - MoTi - Design Supervisor for Highway Design and Survey - Nelson were utilized to helped refine estimates which have since been adjusted for inflation and based on past experience.

<br>

Base costs for installation of bridges on forest service roads and permit roads with surfaces specified in provincial GIS road layers as rough and loose was estimated at \$25000/linear m and assumed that the road could be closed during construction and a minimum bridge span of 15m. For streams with channel widths <2m, embedded culverts were reported as an effective solution with total installation costs estimated at $50k/crossing (pers. comm. Phil MacDonald, Steve Page then adjusted for inflation). For larger streams (>6m), estimated span width increased proportionally to the size of the stream.  For crossings with large amounts of fill (>3m), the replacement bridge span was increased by an additional 3m for each 1m of fill >3m to account for cutslopes to the stream at a 1.5:1 ratio. To account for road type, a multiplier table was generated to estimate incremental cost increases with costs estimated for structure replacement on paved surfaces, railways and arterial/highways costing up to 20 times more than forest service roads due to expenses associate with design/engineering requirements, traffic control and paving.  The cost multiplier table (Table \@ref(tab:tab-cost-mult)) should be considered very approximate with refinement recommended for future projects.


`r if(gitbook_on){knitr::asis_output("<br>")} else knitr::asis_output("\\pagebreak")`

<!-- Turn on once tables.R has been run  -->
```{r tab-cost-mult, eval = F}
tab_cost_rd_mult_report |>
  # filter(Class != 'FSR' & Surface != 'Paved') %>%
  fpr::fpr_kable(caption_text = 'Cost multiplier table based on road class and surface type.', scroll = F)
```

## Designs
Engineering designs were conducted by consultants hired by forest licensees with tenure over the roads and/or timber
harvest planned on the roads where work was conducted.  Completed designs are loaded to the PSCIS data portal.

<br>


## Habitat Confirmation Assessments

Following fish passage assessments, habitat confirmations were completed in accordance with procedures outlined in the document “A Checklist for Fish Habitat Confirmation Prior to the Rehabilitation of a Stream Crossing” [@confirmation_checklist_2011]. The main objective of the field surveys was to document upstream habitat quantity and quality and to determine if any other obstructions exist above or below the crossing.  Habitat value was assessed based on channel morphology, flow characteristics (perennial, intermittent, ephemeral), the presence/absence of deep  pools, un-embedded  boulders, substrate, woody debris, undercut banks, aquatic vegetation and overhanging riparian vegetation. Criteria used to rank habitat value was based on guidelines in @confirmation_checklist_2011 (Table \@ref(tab:tab-hab-value)).

<br>

During habitat confirmations, to standardize data collected and facilitate submission of the data to provincial databases, information was collected on ["Site Cards"](https://www2.gov.bc.ca/gov/content/environment/natural-resource-stewardship/laws-policies-standards-guidance/inventory-standards/aquatic-ecosystems). Habitat characteristics recorded included channel widths, wetted widths, residual pool depths, gradients, bankfull depths, stage, temperature, conductivity, pH, cover by type, substrate and channel morphology (among others). When possible, the crew surveyed downstream of the crossing to a minimum distance 300m and upstream to a minimum distance of 500 - 600m. Any  potential  obstacles  to  fish  passage  were  inventoried  with  photos, physical  descriptions  and  locations  recorded on site cards.  Surveyed routes were recorded with time-signatures on handheld GPS units.

<br>

## Fish Sampling

### Electrofishing 
Fish sampling was conducted on a subset of sites when biological data was considered to add significant value to the physical habitat assessment information. Electrofishing was utilized for fish sampling according to stream inventory standards and procedures found in the Reconnaissance (1:20 000) Fish and Fish Habitat Inventory Manual [@resourcesinventorycommittee2001Reconnaissance20a]. A Haltech 2000 backpack electrofisher was used within discrete site units both upstream and downstream of the subject crossing with electrofisher settings and seconds, water quality parameters (i.e. conductivity, temperature and ph), start and end locations, length of site and wetted widths (average of a minimum of three) recorded. 


<!-- We did not use minnow trapping in 2024 and unsure if we will in the future so leaving this commented out for now. Another section to add in the future will be eDNA sampling. -->
<!-- ### Minnowtrapping -->

<!-- In the case where electrofishing was not a sufficient method of fish sampling, such as deep areas, streams with insufficient conductance, or temperatures below 5 degrees, minnowtraps were used.  -->


### Fish Handling and Processing
Captured fish were held in buckets with sufficient water to minimize stress until processing, and multiple buckets were used when catch numbers were high. For each fish captured, fork length, weight and species was recorded with results documented in the fish data submission spreadsheet.

### Pit Tagging

Fish with a fork length greater than 60 mm and belonging to species approved under the scientific fish collection permit `r fish_col_permit_num` were tagged with Passive Integrated Transponders (PIT tags) using the [Abdominal Cavity](https://www.youtube.com/watch?v=9CKZ9yaS5o8) method outlined by Biomark. To anesthetize fish prior to pit tagging, we used a solution of approximately 0.1 mL of clove oil per 1 L of water (1:10,000). This concentration was selected for its efficiency in providing effective sedation with minimal residual effects, making it ideal for studies in which fish are released back into their natural habitats [@fernandes_etal2017efficacyclove]. The clove oil solution was prepared in advance by dissolving pure clove oil in ethyl alcohol in a 1:9 ratio (clove oil: ethyl alcohol) to enhance solubility, then mixed into the water bucket [@fernandes_etal2017efficacyclove]. Fish were immersed in this solution until they reached an appropriate level of anesthesia for handling and then were tagged. To maintain needle sharpness and minimize injury risk, needles were replaced approximately every 10 fish. Each tagged fish was scanned with the PIT reader, and both the PIT tag ID and row ID were recorded. Once tagged, fish were placed into a bucket of fresh water and allowed to recover before being released back into the stream. Fish information and habitat data will be submitted to the province under scientific fish collection permit `r fish_col_permit_num`.



<!-- Project specific contractors in this paragraph. -->
## Remediations
Structure replacement was conducted by contractors hired by Sinclar (forest licensee).  As-built drawings were completed and loaded to the PSCIS data portal.

<br>



## Climate Change Risk Assessment

In collaboration with the Ministry of Transportation and Infrastructure (MoTi), a new climate change replacement program
aims to prioritize vulnerable culverts for replacement (pers. comm Sean Wong, 2022) based on data collected and ranked
related to three categories - culvert condition, vulnerability and priority. Within the "condition" risk category - data
was collected and crossings were ranked based on erosion, embankment and blockage issues.  The "climate" risk category
included ranked assessments of the likelihood of both a flood event affecting the culvert as well as the consequence of
a flood event affecting the culvert.  Within the "priority" category the following factors were ranked - traffic volume,
community access, cost, constructability, fish bearing status and environmental impacts (Table
\@ref(tab:tab-moti-params)). This project is still in its early stages with methodology changes going forward.

<br>


```{r tab-moti-params, eval=T}
xref_moti_climate_names  %>%
  slice(7:nrow(.)) %>%
  select(spdsht, report) %>%
  rename(Parameter = spdsht, Description = report) %>%
  fpr::fpr_kable(caption_text = 'Climate change data collected at MoTi culvert sites', scroll = gitbook_on)

```

<!--chapter:end:0300-methods.Rmd-->

#  Results 

Here we will grab all the phase 2 sites from past work in northern BC and amalgamate into a table

```{r}
# these are the fraser sites not yet in pscis
# grab a list of the phase 1 crossings surveyed to date
site_ids <- fpr::fpr_import_pscis(dir_root = "~/Projects/repo/fish_passage_fraser_2023_reporting/data") |> 
  dplyr::pull(my_crossing_reference)

site_ids_string <- paste(site_ids, collapse = ", ")
print(site_ids_string)
```

This is a file that can be used to represent phase 2 sites.
```{r}
dir_paths <- c(
  "~/Projects/repo/fish_passage_bulkley_2020_reporting/data",
  "~/Projects/repo/fish_passage_skeena_2021_reporting/data",
  "~/Projects/repo/fish_passage_skeena_2022_reporting/data",
  "~/Projects/repo/fish_passage_bulkley_2022_reporting/data",
  "~/Projects/repo/fish_passage_skeena_2023_reporting/data",
  "~/Projects/repo/fish_passage_skeena_2023_reporting/data",
  # this is a huge repo so to just grab the files in the data directory we run in the cmd
  # mkdir -p Parsnip_Fish_Passage/data then downloaded the file into there from github
  "~/Projects/repo/Parsnip_Fish_Passage/data",
  "~/Projects/repo/fish_passage_peace_2022_reporting/data",
  "~/Projects/repo/fish_passage_peace_2023_reporting/data"
  
)

sites_p2_raw <- dir_paths |> 
  purrr::map(fs::path_expand) |> 
  purrr::map_df(~ {
    data <- fpr::fpr_import_pscis(
      workbook_name = "pscis_phase2.xlsm",
      dir_root = .x
    )
    
    # Add a new column for the full path
    data <- dplyr::mutate(data, path = .x)
    
    return(data)
  }) |> 
  # Get the truncated repo name
  dplyr::mutate(source_repo = basename(fs::path_dir(path))) |> 
  # keep only unique sites
  dplyr::distinct(site_id, .keep_all = TRUE) |> 
  # make it spatial
  fpr::fpr_sp_assign_sf_from_utm()


# we need the sites from 2024 so let's get from the GIS projects
dir_paths_gis <- c(
  "~/Projects/gis/sern_fraser_2024",
  "~/Projects/gis/sern_peace_fwcp_2023",
  "~/Projects/gis/sern_skeena_2023"
)


form_pscis_2024_raw <- dir_paths_gis |> 
  purrr::map(fs::path_expand) |> 
  purrr::map_df(~ {
    data <- sf::st_read(
      dsn = fs::path(.x, "data_field/2024/form_pscis_2024.gpkg")
    )
    
    # Add a new column for the full path
    data <- dplyr::mutate(data, path = .x)
    
    return(data)
  }) |> 
  dplyr::mutate(source_gis = basename(path)) 

sites_p2_gis <- form_pscis_2024_raw |> 
  dplyr::filter(assess_type_phase2 == "Yes")


# for mapping in Q provincial we will just join them and burn into the project
sites_p2 <- dplyr::bind_rows(
  sites_p2_raw,
  sites_p2_gis
)

# quick veiw to see if our phase info is half correct
t <- sites_p2 |> 
  select(1:4, stream_name, road_name, assess_type_phase1, assess_type_phase2, assess_type_reassessment, assessment_comment, fish_sampling, source_repo, source_gis)
 

sites_p2 |> 
  sf::st_write(
    dsn = fs::path_expand("~/Projects/gis/data/fish_passage/fish_passage_summary.gpkg"),
                          layer = "phase2_2024"
  )


sites_p2_string <- paste(site_ids, collapse = ", ")
print(site_ids_string)

```


```{r}
#we want to know all the sites where designs were done.  this will help us with our submissions too
p3_ls <- c(
  # skeena
  197640,
  124500,
  123445,
  124420,
  197379,
  198217,
  58067,
  123377,
  197360, 
  8547, 
  8530, 
  197378,
  
  # fwcp peace
  125231, 
  125000,
  # Chuchinka-Colbourne
  125345, 
  #fern
  125261
  )

# remediations
p4_ls <- c(
  # skeena
  197962,197912,58159,197967,198217,
  
  # fwcp peace
  125231,
  
  
  )

```


<!--chapter:end:0400_results.Rmd-->

`r if (knitr::is_html_output()){ '

# References {-}

<div id="refs"></div>
'}`

<br>

Note that this reference was not actually cited in the body of the report but rather in the `index.Rmd` file `yaml` headerj
under the `no_cite` key.

<!--chapter:end:2000-references.Rmd-->

# Changelog {-}

### mybookdown-template 0.0.4 {-}

  * 20240410
  * add fpr::fpr_kable to intro
  * remove `getwd` from `run.R`
  * stop keeping the `merged_file` (`mybookdown_template.Rmd`)
  * packages.R now uses `pak`


### mybookdown-template 0.0.2 {-}

  * 20220516
  * add references.bib
  * add `NEWS.md` file
  * update `README.md`
  * update logos
  * put date on line with version numbers
  * tighten packages and functions

<!--chapter:end:2090-report-change-log.Rmd-->


# Session Info {-}

Information about the computing environment is important for reproducibility. A summary of the computing environment 
is saved to `session_info.csv` that can be viewed and downloaded from `r paste0(params$repo_url, "session_info.csv")`.

```{r session-info}

if(gitbook_on){
  devtools::session_info(to_file = 'session_info.csv')
} else {
  devtools::session_info()
}

```

<!--chapter:end:2100-session-info.Rmd-->

